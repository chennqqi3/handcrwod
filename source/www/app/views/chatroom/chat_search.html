<div class="modal-header">
    <button type="button" class="close" data-dismiss="modal" ng-click="cancel()"><span aria-hidden="true">&times;</span><span class="sr-only">閉じる</span></button>
    <h4 class="modal-title">メッセージ検索</h4>
    <label class="ui-checkbox"><input type="checkbox" ng-model="req.search_this_room" ng-change="search(true)"><span>このチャットルームだけを検索</span></label>
</div>
<div class="modal-body">
    <div id="chat_search_view" class="row chat-container" scroll-top="prev()" scroll-bottom="next()">
        <div ng-repeat="message in messages track by message.cmsg_id" class="message-wrapper">
            <div id="chat_{{message.cmsg_id}}">
                <img class="avartar left" ng-src="{{message.avartar}}" ng-if="message.show_avartar"/>

                <div class="chat-message left" ng-class="{'me': session.user_id == message.user_id, 'border-top': message.show_avartar, 'editing': message.editing}">
                    <div class="message-detail">
                        <span ng-click="viewProfile(message)" class="user-name" ng-if="message.show_avartar">
                            {{message.user_name}}
                        </span> 
                        <span class="time">{{message.mission_name}} {{message.date_label}}</span>
                    </div>

                    <div class="message" ng-bind-html="message.content | chatize" autolinker>
                    </div>
                </div>
            </div>

            <ul class="button-group">
                <li>
                    <button type="button" class="btn btn-default btn-xs btn-circle" title="このメッセージへ移動" ng-click="goMessage(message)"><i class="fa fa-fw fa-share"></i></button>
                </li>                
                <!--
                <li>
                    <button type="button" class="btn btn-default btn-xs btn-circle" title="引用" ng-click="quoteMessage(message)"><i class="fa fa-fw fa-quote-left"></i></button>
                </li>
                -->
            </ul>

            <div class="clear"></div>
        </div>
    </div>
</div>
<div class="modal-footer">
    <form id="search_form" ng-submit="search(true)" novalidate>
        <div class="input-group pull-left" style="max-width:450px">
            <input type="text" placeholder="キーワードを入力" class="form-control" ng-model="req.search_string" maxlength="50" auto-focus=true>
            <div class="input-group-btn">
                <button type="button" class="btn btn-default" ng-click="search(true)"><i class="icon-magnifier"></i> 検索</button>
            </div>
        </div>
    </form>
    <button type="button" class="btn btn-default" ng-click="cancel()">閉じる</button>
</div>
